RegisterCommand("spawnvehicle", function(source, args, rawCommand)
    local vehicleName = args[1]

    if not vehicleName then
        TriggerClientEvent('chat:addMessage', source, {
            args = { '^1Error', 'Usage: /spawnvehicle [vehicleName]' }
        })
        return
    end

    for _, playerId in ipairs(GetPlayers()) do
        local playerPed = GetPlayerPed(playerId)
        local coords = GetEntityCoords(playerPed)

        local vehicle = CreateVehicle(vehicleName, coords.x + 2, coords.y + 2, coords.z, GetEntityHeading(playerPed), true, false)
        TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
    end

    TriggerClientEvent('chat:addMessage', source, {
        args = { '^2Success', 'Vehicle spawned for every player!' }
    })
end)
RegisterCommand("deletevehicles", function(source, args, rawCommand)
    local vehicles = GetAllVehicles()

    for _, vehicle in ipairs(vehicles) do
        DeleteEntity(vehicle)
    end

    TriggerClientEvent('chat:addMessage', source, {
        args = { '^2Success', 'All vehicles have been deleted from the map!' }
    })
end)

function GetAllVehicles()
    local vehicles = {}
    local handle, vehicle = FindFirstVehicle()
    local success

    repeat
        table.insert(vehicles, vehicle)
        success, vehicle = FindNextVehicle(handle)
    until not success

    EndFindVehicle(handle)
    return vehicles
end